<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Todo一覧</title>
</head>
<body>
    <header>
        <h1>Todo一覧</h1>
        <p>
            {{ request.user.username }} としてログイン中 |
            <a href="{% url 'todo:logout' %}">ログアウト</a>
        </p>
    </header>

    <section>
        <h2>新しいTodoを追加</h2>
        <form method="post">
            {% csrf_token %}
            {{ form.non_field_errors }}
            <div>
                <label for="id_title">タイトル</label>
                {{ form.title }}
                {{ form.title.errors }}
            </div>
            <div>
                <label for="id_description">説明</label>
                {{ form.description }}
                {{ form.description.errors }}
            </div>
            <div>
                <label for="id_completed">
                    {{ form.completed }} 完了とする
                </label>
                {{ form.completed.errors }}
            </div>
            <button type="submit">保存</button>
        </form>
    </section>

    <section>
        <h2>登録済みTodo</h2>
        {% if todos %}
            <ul>
                {% for todo in todos %}
                    <li>
                        <p>
                            <strong>{{ todo.title }}</strong>
                            {% if todo.completed %}<span>（完了）</span>{% endif %}
                        </p>
                        <p>{{ todo.description|default:"(説明なし)" }}</p>
                        <p>作成日時: {{ todo.created_at|date:"Y-m-d H:i" }}</p>
                        <p>
                            <a href="{% url 'todo:todo-edit' todo.pk %}">編集</a>
                            <form method="post" action="{% url 'todo:todo-delete' todo.pk %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit">削除</button>
                            </form>
                        </p>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>まだTodoはありません。</p>
        {% endif %}
    </section>
</body>
</html>

